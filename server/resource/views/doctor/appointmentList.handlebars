<body>
  <div class="site-wrap">
    <nav class="site-nav">
      <div class="name">Patient list</div>

      <ul id="sidebar">

      </ul>

      <div class="note">
        <h3>PDM Project</h3>
        <p>Hospital Data Management</p>
      </div>
    </nav>

    <main>
      <header>
        <h1 id="title">
        </h1>
      </header>

      <div class="appointmentList">
          <div class="col">
          {{#each appointment}}
            <div class="item">
              {{this.name}} | {{this.meetDate}} | {{this.meetTime}}
            </div>
              <a href="" class="btn btn-link" data-toggle="modal" data-id="{{this.pId}}" data-target="#delete-course">Delete</a>
          {{/each}}
          </div>

        </div>
    </main>
  </div>

  <div class="modal fade" id="delete-course" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
          <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel">Confirm delete</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                  </button>
              </div>
              <div class="modal-body">
                  Do you want to delete  ?
              </div>
              <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  <button id="btn-delete-course" type="button" class="btn btn-danger">Delete</button>
              </div>
          </div>
      </div>
  </div>

  <form method="post" id="deleteForm"></form>

</body>

  <script>
    const navTabs = document.querySelectorAll("#nav-tabs > a");
    navTabs.forEach((tab) => {
      tab.addEventListener("click", () => {
        navTabs.forEach((tab) => {
          tab.classList.remove("active");
        });
        tab.classList.add("active");
      });
    });

    let cookies = document.cookie
    let ulTag = document.getElementById("sidebar")

    if (cookies.includes("pId")) {
      ulTag.innerHTML = `          <li class="active">
            <div class="nav_icon">
              <i class="fa-solid fa-bed-pulse"></i>
              <a href="#">Patients</a>
            </div>
            <div class="nav_icon">
                  <i class="fa-solid fa-calendar-check"></i>
                  <a href="#">Book online</a>
                </div>

              <div class="nav_icon">
                  <i class="fa-solid fa-calendar-check"></i>
                  <a href="#">Scheduled appointment</a>
                </div>
            <ul class="sub_nav">
              <li>

              </li>
            </ul>
          </li>`
      let title = document.getElementById("title");
      console.log(title);
      title.innerText = "Patient";
    } else {
      ulTag.innerHTML = ` <li>
            <div class="nav_icon">
              <i class="fa-solid fa-user-doctor"></i>
              <a href="#">Doctors</a>
            </div>
         <div class="nav_icon">
                  <i class="fa-brands fa-wpforms"></i>
                  <a href="/doctor/inchargeform">In charge form</a>
                </div>
          <div class="nav_icon">
                  <i class="fa-solid fa-list"></i>
                  <a href="/doctor/getAllAppointments">Appointment list</a>
                </div>
            </ul>
          </li>`

      let title = document.getElementById("title");
      title.innerText = "Doctor";



        let deleteForm=document.getElementById('deleteForm')
        let courseID;

        //when dialog confirm click
        document.addEventListener('DOMContentLoaded',function () {
            $('#delete-course').on('show.bs.modal', function (event) {
                let button = $(event.relatedTarget) // Button that triggered the modal
                courseID = button.data('id') // Extract info from data-* attributes
            })
        })
        const btndeletecourse=document.getElementById('btn-delete-course')
        console.log(courseID)

        // when delete course btn clicked
        btndeletecourse.onclick=function () {
            deleteForm.action = '/doctor/appointments/' + ${courseID} + '?_method=DELETE'
            deleteForm.submit()
        }
    }
  </script>
